(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["staffManage"],{"1d8b":function(e,t,n){"use strict";n("34fd")},"34fd":function(e,t,n){},eecf:function(e,t,n){"use strict";n.r(t);n("d3b7"),n("7db0"),n("b0c0");var c=n("7a23"),a=(n("42dc"),n("19ec")),o=n.n(a),i=(n("accc"),n("d197")),l=n.n(i),r=n("5530"),f=n("99cb"),u=n("a87f"),d=n("866a"),s=Object(c["createTextVNode"])("取 消"),b=Object(c["createTextVNode"])("确 定"),p=Object(c["defineComponent"])({emits:["submit"],setup:function(e,t){var n=t.expose,a=t.emit,i=Object(c["getCurrentInstance"])().appContext.config.globalProperties,p=Object(c["ref"])({});n({open:v});var m=Object(c["ref"])(!1),O=Object(c["ref"])(),j=Object(c["ref"])([]);function v(e,t,n){j.value=t,O.value=e,n&&(p.value=Object(r["a"])({},n)),m.value=!0}var g=Object(c["ref"])();function C(){m.value=!1,g.value.clearValidate(),p.value={}}function h(){var e,t,n,c,o,l=i.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),r={staffType:null===(e=p.value)||void 0===e?void 0:e.staff_type};"add"===O.value?(r.email=null===(c=p.value)||void 0===c?void 0:c.email,t=f["StaffAdd"],n=u["c"].StaffAdd):(r.uid=null===(o=p.value)||void 0===o?void 0:o.id,t=f["StaffEdit"],n=u["c"].StaffEdit);Object(d["d"])(t,n,r).then((function(e){i.$message.success({message:"add"===O.value?"添加Staff成功":"更新Staff信息成功"}),"add"===O.value&&(p.value.id=JSON.parse(e.msg).id,p.value.is_banned=!1),a("submit",{type:O.value,staff:p.value}),m.value=!1})).catch((function(e){i.$message.warning({message:"添加Staff失败："+(e.msg||""),duration:6e4,showClose:!0})})).finally((function(){l.close()}))}return function(e,t){var n=Object(c["resolveComponent"])("el-input"),a=Object(c["resolveComponent"])("el-form-item"),i=Object(c["resolveComponent"])("el-form"),r=Object(c["resolveComponent"])("el-button"),f=Object(c["resolveComponent"])("el-dialog");return Object(c["openBlock"])(),Object(c["createBlock"])(f,{modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=function(e){return m.value=e}),width:"400px",title:"add"===O.value?"新增Staff":"更新Staff",onClose:C},{footer:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(r,{size:"small",onClick:C},{default:Object(c["withCtx"])((function(){return[s]})),_:1}),Object(c["createVNode"])(r,{size:"small",type:"primary",onClick:h},{default:Object(c["withCtx"])((function(){return[b]})),_:1})]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(i,{model:Object(c["unref"])(p),ref_key:"fromRef",ref:g,size:"small",labelWidth:"110px"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(a,{prop:"email",label:"email：",required:""},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(n,{modelValue:Object(c["unref"])(p).email,"onUpdate:modelValue":t[0]||(t[0]=function(e){return Object(c["unref"])(p).email=e}),autocomplete:"off",clearable:"",disabled:"edit"===O.value},null,8,["modelValue","disabled"])]})),_:1}),Object(c["createVNode"])(a,{prop:"staff_type",label:"角色选择：",required:""},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(Object(c["unref"])(l.a),{modelValue:Object(c["unref"])(p).staff_type,"onUpdate:modelValue":t[1]||(t[1]=function(e){return Object(c["unref"])(p).staff_type=e}),class:"block_select",placeholder:"请选择角色"},{default:Object(c["withCtx"])((function(){return[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(j.value,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(o.a),{key:e.key,label:e.name,value:e.key},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue","title"])}}});const m=p;var O=m,j=n("6c02"),v=n("5502"),g=function(e){return Object(c["pushScopeId"])("data-v-470d7ffc"),e=e(),Object(c["popScopeId"])(),e},C={class:"app_manage"},h={class:"title_wrapper"},k={class:"title"},V=g((function(){return Object(c["createElementVNode"])("span",{class:"title_text"},"Staff管理",-1)})),w={class:"btn_wrapper"},x=Object(c["createTextVNode"])(" 新增 "),_=Object(c["createTextVNode"])(" 移除 "),N=Object(c["createTextVNode"])(" 编辑 "),S=Object(c["defineComponent"])({setup:function(e){var t=Object(c["getCurrentInstance"])().appContext.config.globalProperties,n=Object(v["b"])(),a=Object(j["d"])(),o=Object(c["computed"])((function(){return n.state.staffList}));function i(){var e=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(d["d"])(f["AppCheckout"],u["c"].AppCheckout).then((function(e){n.commit("clearAppInfo"),window.sessionStorage.removeItem("appInfo"),Object(c["nextTick"])((function(){a.push({name:"appManage"})}))})).catch((function(e){t.$message.warning({message:"退出App失败："+(e.msg||""),duration:6e4,showClose:!0})})).finally((function(){e.close()}))}Object(c["onMounted"])((function(){n.state.userInfo.isStaff||!n.state.appInfo.appId?a.push({name:"home"}):(r(),s())}));var l=Object(c["ref"])([]);function r(){Object(d["d"])(f["StaffInfo"],u["c"].StaffInfo).then((function(e){l.value=JSON.parse(e.msg).staff}))}function s(){var e=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(d["d"])(f["StaffList"],u["c"].StaffList).then((function(e){var t=JSON.parse(e.msg);n.commit("setStaffList",t)})).catch((function(e){t.$message.warning({message:"获取Staff列表失败："+(e.msg||""),duration:6e4,showClose:!0})})).finally((function(){e.close()}))}function b(e){t.$confirm("删除该Staff后，将不可找回，请谨慎操作！","移除Staff",{type:"warning",cancelButtonText:"取 消",confirmButtonText:"确 定",callback:function(c){if("confirm"===c){var a=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(d["d"])(f["StaffEdit"],u["c"].StaffEdit,{uid:e.id,del:!0}).then((function(c){n.commit("delStaff",e.id),t.$message.success({message:"移除Staff成功"})})).catch((function(e){t.$message.warning({message:"移除Staff失败："+(e.msg||""),duration:6e4,showClose:!0})})).finally((function(){a.close()}))}}})}function p(e){var t=l.value.find((function(t){return t.key===e}));return(null===t||void 0===t?void 0:t.name)||""}var m=Object(c["ref"])();function g(e,t){m.value.open(e,l.value,t)}function S(e){"add"===e.type?n.commit("addStaff",e.staff):n.commit("updateStaff",e.staff)}return function(e,t){var n=Object(c["resolveComponent"])("el-button"),a=Object(c["resolveComponent"])("el-tooltip"),l=Object(c["resolveComponent"])("el-table-column"),r=Object(c["resolveComponent"])("el-table");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createElementVNode"])("div",C,[Object(c["createElementVNode"])("div",h,[Object(c["createElementVNode"])("div",k,[Object(c["createVNode"])(a,{effect:"dark",content:"退出",placement:"bottom"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(n,{size:"mini",class:"back_btn",type:"text",icon:"el-icon-back",onClick:t[0]||(t[0]=function(e){return i()}),circle:""})]})),_:1}),V,Object(c["createVNode"])(a,{effect:"dark",content:"刷新",placement:"bottom"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(n,{size:"mini",class:"back_btn",type:"text",icon:"el-icon-refresh",onClick:t[1]||(t[1]=function(e){return s()}),circle:""})]})),_:1})]),Object(c["createElementVNode"])("div",w,[Object(c["createVNode"])(n,{type:"primary",icon:"el-icon-plus",size:"small",onClick:t[2]||(t[2]=function(e){return g("add")})},{default:Object(c["withCtx"])((function(){return[x]})),_:1})])]),Object(c["createVNode"])(r,{class:"main_wrapper",data:Object(c["unref"])(o),border:"",maxHeight:"650px"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(l,{prop:"id",label:"ID",minWidth:"80"}),Object(c["createVNode"])(l,{prop:"email",label:"email",minWidth:"130"}),Object(c["createVNode"])(l,{prop:"staff_type",label:"角色",minWidth:"140"},{default:Object(c["withCtx"])((function(e){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(p(e.row.staff_type)),1)]})),_:1}),Object(c["createVNode"])(l,{prop:"is_banned",label:"用户状态",minWidth:"80"},{default:Object(c["withCtx"])((function(e){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.row.is_banned?"已冻结":"正常"),1)]})),_:1}),Object(c["createVNode"])(l,{label:"操作",minWidth:"200"},{default:Object(c["withCtx"])((function(e){return[Object(c["createVNode"])(n,{type:"danger",icon:"el-icon-delete",size:"mini",onClick:function(t){return b(e.row)}},{default:Object(c["withCtx"])((function(){return[_]})),_:2},1032,["onClick"]),Object(c["createVNode"])(n,{type:"primary",icon:"el-icon-edit",size:"mini",onClick:function(t){return g("edit",e.row)}},{default:Object(c["withCtx"])((function(){return[N]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])]),Object(c["createVNode"])(O,{ref_key:"staffDialogRef",ref:m,onSubmit:S},null,512)],64)}}}),y=(n("1d8b"),n("6b0d")),I=n.n(y);const E=I()(S,[["__scopeId","data-v-470d7ffc"]]);t["default"]=E}}]);