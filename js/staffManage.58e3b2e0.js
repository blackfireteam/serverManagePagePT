(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["staffManage"],{1359:function(e,t,n){"use strict";n("4746")},4746:function(e,t,n){},eecf:function(e,t,n){"use strict";n.r(t);n("d3b7"),n("7db0"),n("b0c0");var c=n("7a23"),a=(n("42dc"),n("19ec")),o=n.n(a),i=(n("accc"),n("d197")),l=n.n(i),r=n("5530"),f=n("99cb"),u=n("a87f"),d=n("866a"),b=n("44a6"),s=Object(c["createTextVNode"])("取 消"),p=Object(c["createTextVNode"])("确 定"),O=Object(c["defineComponent"])({emits:["submit"],setup:function(e,t){var n=t.expose,a=t.emit,i=Object(c["getCurrentInstance"])().appContext.config.globalProperties,O=Object(c["ref"])({});n({open:g});var j=Object(c["ref"])(!1),m=Object(c["ref"])(),v=Object(c["ref"])([]);function g(e,t,n){v.value=t,m.value=e,n&&(O.value=Object(r["a"])({},n)),j.value=!0}var C=Object(c["ref"])();function h(){j.value=!1,C.value.clearValidate(),O.value={}}function k(){var e,t,n,c,o,l=i.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),r={staffType:null===(e=O.value)||void 0===e?void 0:e.staff_type};"add"===m.value?(r.email=null===(c=O.value)||void 0===c?void 0:c.email,t=f["StaffAdd"],n=u["d"].StaffAdd):(r.uid=null===(o=O.value)||void 0===o?void 0:o.id,t=f["StaffEdit"],n=u["d"].StaffEdit);Object(d["d"])(t,n,r).then((function(e){var t="add"===m.value?"添加Staff成功":"更新Staff信息成功";Object(b["d"])(i.$message,t,"success"),"add"===m.value&&(O.value.id=JSON.parse(e.msg).id,O.value.is_banned=!1),a("submit",{type:m.value,staff:O.value}),j.value=!1})).catch((function(e){Object(b["d"])(i.$message,"添加Staff失败：".concat(e.msg||""))})).finally((function(){l.close()}))}return function(e,t){var n=Object(c["resolveComponent"])("el-input"),a=Object(c["resolveComponent"])("el-form-item"),i=Object(c["resolveComponent"])("el-form"),r=Object(c["resolveComponent"])("el-button"),f=Object(c["resolveComponent"])("el-dialog");return Object(c["openBlock"])(),Object(c["createBlock"])(f,{modelValue:j.value,"onUpdate:modelValue":t[2]||(t[2]=function(e){return j.value=e}),width:"400px",title:"add"===m.value?"新增Staff":"更新Staff",onClose:h},{footer:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(r,{size:"small",onClick:h},{default:Object(c["withCtx"])((function(){return[s]})),_:1}),Object(c["createVNode"])(r,{size:"small",type:"primary",onClick:k},{default:Object(c["withCtx"])((function(){return[p]})),_:1})]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(i,{model:Object(c["unref"])(O),ref_key:"fromRef",ref:C,size:"small",labelWidth:"110px"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(a,{prop:"email",label:"email：",required:""},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(n,{modelValue:Object(c["unref"])(O).email,"onUpdate:modelValue":t[0]||(t[0]=function(e){return Object(c["unref"])(O).email=e}),autocomplete:"off",clearable:"",disabled:"edit"===m.value},null,8,["modelValue","disabled"])]})),_:1}),Object(c["createVNode"])(a,{prop:"staff_type",label:"角色选择：",required:""},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(Object(c["unref"])(l.a),{modelValue:Object(c["unref"])(O).staff_type,"onUpdate:modelValue":t[1]||(t[1]=function(e){return Object(c["unref"])(O).staff_type=e}),class:"block_select",placeholder:"请选择角色"},{default:Object(c["withCtx"])((function(){return[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(v.value,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(o.a),{key:e.key,label:e.name,value:e.key},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue","title"])}}});const j=O;var m=j,v=n("6c02"),g=n("5502"),C=function(e){return Object(c["pushScopeId"])("data-v-32f4aaec"),e=e(),Object(c["popScopeId"])(),e},h={class:"app_manage"},k={class:"title_wrapper"},V={class:"title"},x=C((function(){return Object(c["createElementVNode"])("span",{class:"title_text"},"Staff管理",-1)})),_={class:"btn_wrapper"},N=Object(c["createTextVNode"])(" 新增 "),S=Object(c["createTextVNode"])(" 移除 "),w=Object(c["createTextVNode"])(" 编辑 "),y=Object(c["defineComponent"])({setup:function(e){var t=Object(c["getCurrentInstance"])().appContext.config.globalProperties,n=Object(g["b"])(),a=Object(v["d"])(),o=Object(c["computed"])((function(){return n.state.staffList}));function i(){var e=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(d["d"])(f["AppCheckout"],u["d"].AppCheckout).then((function(e){n.commit("clearAppInfo"),window.sessionStorage.removeItem("appInfo"),Object(c["nextTick"])((function(){a.push({name:"appManage"})}))})).catch((function(e){Object(b["d"])(t.$message,"退出App失败：".concat(e.msg||""))})).finally((function(){e.close()}))}Object(c["onMounted"])((function(){n.state.userInfo.isStaff||!n.state.appInfo.appId?a.push({name:"home"}):(r(),s())}));var l=Object(c["ref"])([]);function r(){Object(d["d"])(f["StaffInfo"],u["d"].StaffInfo).then((function(e){l.value=JSON.parse(e.msg).staff}))}function s(){var e=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(d["d"])(f["StaffList"],u["d"].StaffList).then((function(e){var t=JSON.parse(e.msg);n.commit("setStaffList",t)})).catch((function(e){Object(b["d"])(t.$message,"获取Staff列表失败：".concat(e.msg||""))})).finally((function(){e.close()}))}function p(e){t.$confirm("删除该Staff后，将不可找回，请谨慎操作！","移除Staff",{type:"warning",cancelButtonText:"取 消",confirmButtonText:"确 定",callback:function(c){if("confirm"===c){var a=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(d["d"])(f["StaffEdit"],u["d"].StaffEdit,{uid:e.id,del:!0}).then((function(c){n.commit("delStaff",e.id),Object(b["d"])(t.$message,"移除Staff成功","success")})).catch((function(e){Object(b["d"])(t.$message,"移除Staff失败：".concat(e.msg||""))})).finally((function(){a.close()}))}}})}function O(e){var t=l.value.find((function(t){return t.key===e}));return(null===t||void 0===t?void 0:t.name)||""}var j=Object(c["ref"])();function C(e,t){j.value.open(e,l.value,t)}function y(e){"add"===e.type?n.commit("addStaff",e.staff):n.commit("updateStaff",e.staff)}return function(e,t){var n=Object(c["resolveComponent"])("el-button"),a=Object(c["resolveComponent"])("el-tooltip"),l=Object(c["resolveComponent"])("el-table-column"),r=Object(c["resolveComponent"])("el-table");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createElementVNode"])("div",h,[Object(c["createElementVNode"])("div",k,[Object(c["createElementVNode"])("div",V,[Object(c["createVNode"])(a,{effect:"dark",content:"退出",placement:"bottom"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(n,{size:"mini",class:"back_btn",type:"text",icon:"el-icon-back",onClick:t[0]||(t[0]=function(e){return i()}),circle:""})]})),_:1}),x,Object(c["createVNode"])(a,{effect:"dark",content:"刷新",placement:"bottom"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(n,{size:"mini",class:"back_btn",type:"text",icon:"el-icon-refresh",onClick:t[1]||(t[1]=function(e){return s()}),circle:""})]})),_:1})]),Object(c["createElementVNode"])("div",_,[Object(c["createVNode"])(n,{type:"primary",icon:"el-icon-plus",size:"small",onClick:t[2]||(t[2]=function(e){return C("add")})},{default:Object(c["withCtx"])((function(){return[N]})),_:1})])]),Object(c["createVNode"])(r,{class:"main_wrapper",data:Object(c["unref"])(o),border:"",maxHeight:"650px"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(l,{prop:"id",label:"ID",minWidth:"80"}),Object(c["createVNode"])(l,{prop:"email",label:"email",minWidth:"130"}),Object(c["createVNode"])(l,{prop:"staff_type",label:"角色",minWidth:"140"},{default:Object(c["withCtx"])((function(e){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(O(e.row.staff_type)),1)]})),_:1}),Object(c["createVNode"])(l,{prop:"is_banned",label:"用户状态",minWidth:"80"},{default:Object(c["withCtx"])((function(e){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.row.is_banned?"已冻结":"正常"),1)]})),_:1}),Object(c["createVNode"])(l,{label:"操作",minWidth:"200"},{default:Object(c["withCtx"])((function(e){return[Object(c["createVNode"])(n,{type:"danger",icon:"el-icon-delete",size:"mini",onClick:function(t){return p(e.row)}},{default:Object(c["withCtx"])((function(){return[S]})),_:2},1032,["onClick"]),Object(c["createVNode"])(n,{type:"primary",icon:"el-icon-edit",size:"mini",onClick:function(t){return C("edit",e.row)}},{default:Object(c["withCtx"])((function(){return[w]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])]),Object(c["createVNode"])(m,{ref_key:"staffDialogRef",ref:j,onSubmit:y},null,512)],64)}}}),I=(n("1359"),n("6b0d")),E=n.n(I);const T=E()(y,[["__scopeId","data-v-32f4aaec"]]);t["default"]=T}}]);