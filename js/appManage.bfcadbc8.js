(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["appManage"],{"4ff4":function(e,t,n){"use strict";n("5f53")},"534d":function(e,t,n){"use strict";n.r(t);n("d3b7"),n("b0c0"),n("e9c4"),n("7db0");var c=n("7a23"),o=n("5530"),a=n("866a"),i=n("a87f"),r=n("99cb"),l={class:"dialog-footer"},u=Object(c["createTextVNode"])("取 消"),s=Object(c["createTextVNode"])("确 定"),d=Object(c["defineComponent"])({emits:["submit"],setup:function(e,t){var n=t.expose,d=t.emit,f=Object(c["getCurrentInstance"])().appContext.config.globalProperties,p=Object(c["reactive"])({email:""});n({open:O});var b=Object(c["ref"])(!1),m=Object(c["ref"])();function O(e){m.value=e,b.value=!0}var j=Object(c["ref"])();function g(){b.value=!1,j.value.clearValidate(),p.email=""}function v(){var e={appId:m.value,email:p.email},t=f.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(a["d"])(r["AppAssign"],i["c"].AppAssign,e).then((function(t){var n=JSON.parse(t.msg);d("submit",Object(o["a"])(Object(o["a"])({},e),{},{id:n.id})),f.$message.success({message:"设置App管理员成功"}),b.value=!1})).catch((function(e){f.$message.warning({message:"设置失败："+(e.msg||""),duration:6e4,showClose:!0})})).finally((function(){t.close()}))}return function(e,t){var n=Object(c["resolveComponent"])("el-input"),o=Object(c["resolveComponent"])("el-form-item"),a=Object(c["resolveComponent"])("el-form"),i=Object(c["resolveComponent"])("el-button"),r=Object(c["resolveComponent"])("el-dialog");return Object(c["openBlock"])(),Object(c["createBlock"])(r,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=function(e){return b.value=e}),width:"400px",title:"设置App管理员",onClose:g},{footer:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("span",l,[Object(c["createVNode"])(i,{size:"small",onClick:g},{default:Object(c["withCtx"])((function(){return[u]})),_:1}),Object(c["createVNode"])(i,{size:"small",type:"primary",onClick:v},{default:Object(c["withCtx"])((function(){return[s]})),_:1})])]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(a,{model:Object(c["unref"])(p),ref_key:"fromRef",ref:j,size:"small",labelWidth:"60px"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(o,{label:"email："},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(n,{modelValue:Object(c["unref"])(p).email,"onUpdate:modelValue":t[0]||(t[0]=function(e){return Object(c["unref"])(p).email=e}),autocomplete:"off",clearable:""},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue"])}}});const f=d;var p=f,b=n("6c02"),m=n("0613"),O=function(e){return Object(c["pushScopeId"])("data-v-9b70613a"),e=e(),Object(c["popScopeId"])(),e},j={class:"app_manage"},g={class:"title_wrapper"},v={class:"title"},h=O((function(){return Object(c["createElementVNode"])("span",{class:"title_text"},"App管理",-1)})),C={class:"main_wrapper"},k=Object(c["createTextVNode"])(" 管理 "),w=Object(c["createTextVNode"])(" 取消App管理员 "),N=Object(c["createTextVNode"])(" 设置App管理员 "),V=Object(c["defineComponent"])({setup:function(e){var t=Object(c["getCurrentInstance"])().appContext.config.globalProperties,n=Object(b["d"])(),o=Object(c["computed"])((function(){return m["a"].state.userInfo})),l=Object(c["ref"])([]);function u(){var e=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(a["d"])(r["AppList"],i["c"].AppList).then((function(e){l.value=JSON.parse(e.msg)})).catch((function(e){})).finally((function(){e.close()}))}function s(e){var l=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(a["d"])(r["AppCheckout"],i["c"].AppCheckout,{appId:e.id}).then((function(a){t.$message.success({message:"checkOut App 成功"});var i={appId:e.id,appTitle:e.name,managerEmail:e.email};m["a"].commit("setAppInfo",i),window.sessionStorage.setItem("appInfo",JSON.stringify(i)),o.value.isStaff?d(l):(l.close(),Object(c["nextTick"])((function(){n.push({name:"appState"})})))})).catch((function(e){l.close(),t.$message.warning({message:"checkOut App 失败："+(e.msg||""),duration:6e4,showClose:!0})}))}function d(e){Object(a["d"])(r["StaffInfo"],i["c"].StaffInfo).then((function(e){m["a"].commit("setStaffInfo",JSON.parse(e.msg)),Object(c["nextTick"])((function(){n.push({name:"appState"})}))})).catch((function(e){t.$message.warning({message:"获取Staff权限信息失败："+(e.msg||""),duration:6e4,showClose:!0})})).finally((function(){e.close()}))}Object(c["onMounted"])((function(){u()}));var f=Object(c["ref"])();function O(e){f.value.open(e)}function V(e){var t=l.value.find((function(t){return t.id===e.appId}));t&&(t.email=e.email,t.uid=e.id)}function x(e){var n={appId:e.id,del:!0},c=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(a["d"])(r["AppAssign"],i["c"].AppAssign,n).then((function(n){e.uid=void 0,e.email="",t.$message.success({message:"操作成功"})})).catch((function(e){t.$message.warning({message:"取消管理员失败："+(e.msg||""),duration:6e4,showClose:!0})})).finally((function(){c.close()}))}return function(e,t){var n=Object(c["resolveComponent"])("el-button"),a=Object(c["resolveComponent"])("el-tooltip"),i=Object(c["resolveComponent"])("el-table-column"),r=Object(c["resolveComponent"])("el-table");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createElementVNode"])("div",j,[Object(c["createElementVNode"])("div",g,[Object(c["createElementVNode"])("div",v,[h,Object(c["createVNode"])(a,{effect:"dark",content:"刷新",placement:"bottom"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(n,{size:"mini",class:"refresh_btn",type:"text",icon:"el-icon-refresh",onClick:t[0]||(t[0]=function(e){return u()}),circle:""})]})),_:1})])]),Object(c["createElementVNode"])("div",C,[Object(c["createVNode"])(r,{data:l.value,border:"",maxHeight:"650px"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(i,{prop:"id",label:"AppID",minWidth:"80"}),Object(c["createVNode"])(i,{prop:"name",label:"AppName",minWidth:"150"}),Object(c["unref"])(o).isStaff?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])(i,{key:0,prop:"uid",label:"管理员id",minWidth:"160"},{default:Object(c["withCtx"])((function(e){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.row.uid?e.row.uid:""),1)]})),_:1})),Object(c["unref"])(o).isStaff?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])(i,{key:1,prop:"email",label:"管理员邮箱",minWidth:"170"})),Object(c["createVNode"])(i,{prop:"total_reg_count",label:"总用户数",minWidth:"80"}),Object(c["createVNode"])(i,{prop:"total_msg_count",label:"总消息数",minWidth:"80"}),Object(c["createVNode"])(i,{label:"操作",minWidth:"220"},{default:Object(c["withCtx"])((function(e){return[Object(c["createVNode"])(n,{type:"primary",size:"mini",onClick:function(t){return s(e.row)}},{default:Object(c["withCtx"])((function(){return[k]})),_:2},1032,["onClick"]),Object(c["unref"])(o).userManage&&e.row.email?(Object(c["openBlock"])(),Object(c["createBlock"])(n,{key:0,type:"danger",size:"mini",onClick:function(t){return x(e.row)}},{default:Object(c["withCtx"])((function(){return[w]})),_:2},1032,["onClick"])):Object(c["unref"])(o).userManage?(Object(c["openBlock"])(),Object(c["createBlock"])(n,{key:1,type:"primary",size:"mini",onClick:function(t){return O(e.row.id)}},{default:Object(c["withCtx"])((function(){return[N]})),_:2},1032,["onClick"])):Object(c["createCommentVNode"])("",!0)]})),_:1})]})),_:1},8,["data"])])]),Object(c["createVNode"])(p,{ref_key:"appAdminDialog",ref:f,onSubmit:V},null,512)],64)}}}),x=(n("4ff4"),n("6b0d")),_=n.n(x);const A=_()(V,[["__scopeId","data-v-9b70613a"]]);t["default"]=A},"5f53":function(e,t,n){},"6b0d":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e,t)=>{const n=e.__vccOpts||e;for(const[c,o]of t)n[c]=o;return n}},e9c4:function(e,t,n){var c=n("23e7"),o=n("da84"),a=n("d066"),i=n("2ba4"),r=n("e330"),l=n("d039"),u=o.Array,s=a("JSON","stringify"),d=r(/./.exec),f=r("".charAt),p=r("".charCodeAt),b=r("".replace),m=r(1..toString),O=/[\uD800-\uDFFF]/g,j=/^[\uD800-\uDBFF]$/,g=/^[\uDC00-\uDFFF]$/,v=function(e,t,n){var c=f(n,t-1),o=f(n,t+1);return d(j,e)&&!d(g,o)||d(g,e)&&!d(j,c)?"\\u"+m(p(e,0),16):e},h=l((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&c({target:"JSON",stat:!0,forced:h},{stringify:function(e,t,n){for(var c=0,o=arguments.length,a=u(o);c<o;c++)a[c]=arguments[c];var r=i(s,null,a);return"string"==typeof r?b(r,O,v):r}})}}]);